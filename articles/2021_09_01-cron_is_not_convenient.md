# 应用内使用crontab不是那么方便

以前我一直是 cron 的忠实用户，毕竟这么多年了，cron 非常稳定。我一直说 cron 简单粗暴，坚如磐石。但是随着使用 cron 越多，
我越是发现不太方便的一些地方，主要是在应用开发里。

比如，当我们的应用需要执行一些定时任务，如果使用 crontab，或者 systemd timer，有这样的缺点：

- 每增加一个定时任务，都要在应用里增加一个参数，或者子命令，这样 crontab 才能执行到具体的新的代码块
- cron 其实是有权限问题的，它所使用的环境变量也和正常登录的用户不太一样，比如 `PATH`，这些都在 `/etc/crontab` 里配置
- cron 执行之后，日志需要单独写一个文件，所以每次也要配置一下，而且还要注意日志文件所在路径是否有写的权限
- debug 不太方便，当然了，主要还是靠日志，不过我一般也主要都靠日志来debug，所以这一点问题不算特别大
- 绑定在某一台机器上，当然，如果用的k8s之类的，也可以起一个 cron 然后每次都导入规则

大量使用 cron 之后，很容易遇到上述问题。所以我最后还是切换到了对应语言的库。比如 Python 我一般用
[APScheduler](https://github.com/agronholm/apscheduler) ，Go我一般用 [gocron](https://github.com/go-co-op/gocron) 。

使用定时任务库之后，优点就是使用上比较方便，而且他们提供的语法都比较人性化，日志也统一收集了。缺点就是，如果应用挂了，
那么所有的定时任务都会受影响。但是后面这一点是可以靠提高应用的健壮性来消除的。
